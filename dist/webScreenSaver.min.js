!function(i,s,n){"use strict";var e={videos:[],videoDuration:-1,interval:12e4,stagnantDelay:5e3,stagnantTrigger:!0,target:s.querySelector("body"),triggerKeycode:32,nextVidKeycode:39},r=function(t,e){return n.floor(n.random()*(e-t+1)+t)},o=function(){Promise.settle=function(t){t=t.map(function(t){return t.then(function(t){return{result:t,status:"resolved"}},function(t){return{result:t,status:"rejected"}})});return Promise.all(t)};return function(){var i=this;this.promise=new Promise(function(t,e){i.resolve=t,i.reject=e}),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)}}(),a=(l.all=function(t,i){if(!Array.isArray(t)||t.length<2)throw new Error("first argument should be an array with at least two elements");return t.reduce(function(t,e){return l(t,e,i)})},l);function u(t){return t&&"object"==typeof t&&"[object RegExp]"!==Object.prototype.toString.call(t)&&"[object Date]"!==Object.prototype.toString.call(t)}function d(t,e){return e&&!0===e.clone&&u(t)?l(Array.isArray(t)?[]:{},t,e):t}function h(i,t,n){var r=i.slice();return t.forEach(function(t,e){void 0===r[e]?r[e]=d(t,n):u(t)?r[e]=l(i[e],t,n):-1===i.indexOf(t)&&r.push(d(t,n))}),r}function l(t,e,i){var n,r,o,s,a=Array.isArray(e),c=(i||{arrayMerge:h}).arrayMerge||h;return a?Array.isArray(t)?c(t,e,i):d(e,i):(n=t,r=e,s=(o=i)&&o.mutate?n:{},u(n)&&Object.keys(n).forEach(function(t){s[t]=d(n[t],o)}),Object.keys(r).forEach(function(t){u(r[t])&&n[t]?s[t]=l(n[t],r[t],o):s[t]=d(r[t],o)}),s)}var VidCon=function(){function VidCon(t){this.target=t,this.transitionDuration=1e3,this.$=s.createElement("video"),this.$.classList.add("vidcon"),this.$.setAttribute("autoplay","autoplay"),this.$.setAttribute("muted","muted"),this.$.muted=!0,this.$.style.width="100%",this.$.style.height="100%",this.$.style.objectFit="cover",this.$.style.opacity="0",this.$.style.transition="opacity 1s linear",this.$.style.top=0,this.$.style.bottom=0,this.$.style.left=0,this.$.style.right=0,"body"===this.target.tagName.toLowerCase()?this.$.style.position="fixed":this.$.style.position="absolute"}return VidCon.prototype.setVideo=function(n){for(var t=s.createDocumentFragment(),r=Object.keys(n),o=0;o<r.length;o++)!function(){var e=r[o],i=s.createElement("source");i.setAttribute("type","video/"+e),i.setAttribute("src",n[e]),i.addEventListener("error",function(t){i.dispatchEvent(new CustomEvent("sourceloadfailed",{bubbles:!0,detail:{src:n[e]}}))}),t.appendChild(i)}();this.$.innerHTML="",this.$.appendChild(t)},VidCon.prototype.fadeIn=function(){var t=this,e=new o;return this.$.addEventListener("loadeddata",function(){t.$.play().catch(t=>console.error("> autoplay prevented",t)),t.$.style.opacity=1,setTimeout(function(){e.resolve()},this.transitionDuration)}),this.$.addEventListener("sourceloadfailed",t=>{t.stopPropagation(),e.reject(t)}),this.target.appendChild(this.$),e.promise},VidCon.prototype.fadeOut=function(){var t=this,e=new o;return t.$.style.opacity=0,setTimeout(function(){t.destroy(),e.resolve()},this.transitionDuration),e.promise},VidCon.prototype.destroy=function(){this.$.remove()},VidCon}();function WebScreensaver(t){if(this.config=a(e,t),this.target=t.target||e.target,this.currentVid=null,this.stagnantTimeout=null,this.isRunning=!1,this.setTargetStyle(),!this.config.videos||this.config.videos.length<=0)throw"Error: No videos provided.";this.config.stagnantTrigger?this.startWindowMonitor():this.startControlMonitor()}WebScreensaver.prototype.setTargetStyle=function(){this.target!==e.target&&(this.target.style.overflow="hidden","static"===this.target.style.position)&&(this.target.style.position="relative")},WebScreensaver.prototype.startSaver=function(){var e=this;this.isRunning=!0,this.toggleVideos().then(function(t){t=1e3*(t.$.duration-t.$.currentTime),t=t<e.config.interval?t:e.config.interval;setTimeout(function(){e.isRunning&&e.startSaver()},t)}).catch(t=>{console.error("> failed to toggle videos",t),e.startSaver()})},WebScreensaver.prototype.stopSaver=function(){this.isRunning=!1,this.currentVid&&(this.currentVid.destroy(),this.currentVid=null)},WebScreensaver.prototype.toggleVideos=function(){var e=new o,t=this,i=r(0,this.config.videos.length-1),i=this.config.videos[i],n=new VidCon(this.target);return n.setVideo(i),n.fadeIn().then(function(){t.currentVid&&t.currentVid.fadeOut(),t.currentVid=n,e.resolve(t.currentVid)}).catch(t=>{n.destroy(),e.reject(t)}),e.promise},WebScreensaver.prototype.startWindowMonitor=function(){function t(){i.clearTimeout(e.stagnantTimeout),e.stopSaver(),e.stagnantTimeout=setTimeout(function(){e.startSaver()},e.config.stagnantDelay)}var e=this;this.stagnantTimeout=setTimeout(function(){e.startSaver()},this.config.stagnantDelay);i.addEventListener("click",t),i.addEventListener("mousemove",t),i.addEventListener("mousedown",t),i.addEventListener("keydown",t)},WebScreensaver.prototype.startControlMonitor=function(){var e=this;i.addEventListener("keydown",function(t){t=t.which;t===e.config.triggerKeycode?e.currentVid?e.stopSaver():e.startSaver():t===e.config.nextVidKeycode&&e.currentVid&&e.toggleVideos()})},i.WebScreensaver=WebScreensaver}(window,document,Math);